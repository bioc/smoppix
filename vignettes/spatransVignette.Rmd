---
title: "Vignette of the spatrans package"
author: Stijn Hawinkel
output: 
  rmarkdown::html_vignette:
    toc: true
    number_sections: true
    keep_md: true
vignette: >
  %\VignetteIndexEntry{Vignette of the oosse package}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

# Introduction

This vignette demonstrates the use of the __spatrans__ package for statistical inference on single-molecule spatial transcriptomics datasets with replication.

\setcounter{tocdepth}{5}
\tableofcontents

# Installation instructions

The package can be installed from Bioconductor as follows:

```{r install, eval = FALSE}
library(Biocmanager)
install("spatrans")
```

Alternatively, the latest version can be downloaded from github as:

```{r installAndLoadGitHub, eval = FALSE}
library(devtools)
install_github("CenterForStatistics-UGent/spatrans")
```

```{r load}
library(spatrans)
```

# Example dataset

As example dataset we use the data by \textcite{Yang2023} on _Selaginella moellendorffii_. Only a subset of the data, consisting of sections 1-3 of roots 1-3 is included for computational reasons. The data is loaded as follows.

```{r}
data(Yang)
```

It is a dataframe containing molecule locations (x- and y-variables), gene identity and covariates: day, root and section. At each day, 6 roots were measured, with varying numbers of sections for each root. The analysis will need to account for this nested design.

The first step in the analysis is to build a hyperframe as provided in the _spatstat_ package, which consists of all different point patterns and their covariates

```{r}
hypYang = buildHyperFrame(Yang, coordVars = c("x", "y"), designVar = c("day", "root", "section"))
```

As printed by the code, `r nrow(hypYang)` design factors or point patterns were found. We take a closer look at the hyperframe

```{r}
hypYang
```

We see the following elements:

 - __ppp__: the _spatstat_ point patterns of class _ppp_
 - __design__: The design variable uniquely defining each point pattern. Is a concatenation of the day, root and section variables.
 - __day__, __root__ and __section__: the covariates
 - __tabObs__: tabulation of the frequency of each gene in each point pattern
 
 Zooming in on the first point pattern:
 
```{r}
hypYang$ppp[[1]]
```

# Analyses

## Univariate tests

### Tests for vicinity to cell wall or fixed point: distances to fixed objects

### Tests for univariate aggregation or regularity: interevent distances

## Bivariate tests

### Tests for colocalization or antilocalization: interfeature distances
 
# Session info

```{r}
sessionInfo()
```


